{%- assign headings_font = settings.headings_font -%}
{%- assign body_font = settings.body_font -%}
{%- assign quotes_font = settings.typography_quotes_new -%}

<link rel="preload" href="{{ headings_font | font_url }}" as="font" type="font/woff2" crossorigin>

{%- if body_font != headings_font -%}
  <link rel="preload" href="{{ body_font | font_url }}" as="font" type="font/woff2" crossorigin>
{%- endif -%}

{%- if body_font != quotes_font -%}
  <link rel="preload" href="{{ quotes_font | font_url }}" as="font" type="font/woff2" crossorigin>
{%- endif -%}

<style type="text/css">

  {%- comment -%} sidebar background color {%- endcomment -%}

  {%- assign color_sidebar_bg = settings.sidebar_bg -%}
  {%- assign color_sidebar_bg_darken = settings.sidebar_bg | color_darken: 4 -%}
  {%- assign color_sidebar_bg_brightness = color_sidebar_bg | color_brightness -%}
  {%- if color_sidebar_bg_brightness < 10 -%}
    {%- assign color_sidebar_bg_darken_alt = settings.sidebar_bg | color_lighten: 6 -%}
  {%- else -%}
    {%- assign color_sidebar_bg_darken_alt = settings.sidebar_bg | color_darken: 4 -%}
  {%- endif -%}
  {%- assign color_sidebar_bg_lighten = settings.sidebar_bg | color_lighten: 4 -%}
  {%- assign color_sidebar_bg_lighten_alt = settings.sidebar_bg | color_lighten: 8 -%}

  {%- comment -%} sidebar text color {%- endcomment -%}

  {%- assign color_sidebar_txt = settings.sidebar_txt -%}
  {%- assign color_sidebar_txt_brightness = color_sidebar_txt | color_brightness -%}
  {%- if color_sidebar_txt_brightness > 150 -%}
    {%- assign color_sidebar_txt_foreground = '#000' -%}
  {%- else -%}
    {%- assign color_sidebar_txt_foreground = '#fff' -%}
  {%- endif -%}
  {%- assign color_sidebar_txt_lighten_alt = settings.sidebar_txt | color_lighten: 66 -%}

  {%- comment -%} sidebar accent color {%- endcomment -%}

  {%- assign color_sidebar_accent = settings.sidebar_accent -%}
  {%- assign color_sidebar_accent_brightness = color_sidebar_accent | color_brightness -%}
  {%- if color_sidebar_accent_brightness > 150 -%}
    {%- assign color_sidebar_accent_foreground = '#000' -%}
  {%- else -%}
    {%- assign color_sidebar_accent_foreground = '#fff' -%}
  {%- endif -%}

  {%- comment -%} body background color {%- endcomment -%}

  {%- assign color_body_bg = settings.body_bg -%}
  {%- assign color_body_bg_darken = settings.body_bg | color_darken: 4 -%}
  {%- assign color_body_bg_darken_alt = settings.body_bg | color_darken: 8 -%}

  {%- comment -%} body text color {%- endcomment -%}

  {%- assign color_body_txt = settings.body_txt -%}
  {%- assign color_body_txt_brightness = color_body_txt | color_brightness -%}
  {%- assign color_body_txt_lighten = settings.body_txt | color_lighten: 66 -%}
  {%- if color_body_txt_brightness > 150 -%}
    {%- assign color_body_txt_foreground = '#000' -%}
  {%- else -%}
    {%- assign color_body_txt_foreground = '#fff' -%}
  {%- endif -%}

  {%- comment -%} body accent color {%- endcomment -%}

  {%- assign color_body_accent = settings.body_accent -%}
  {%- assign color_body_accent_brightness = color_body_accent | color_brightness -%}

  {%- if color_body_accent_brightness > 150 -%}
    {%- assign color_body_accent_foreground = '#000' -%}
  {%- else -%}
    {%- assign color_body_accent_foreground = '#fff' -%}
  {%- endif -%}

  {%- comment -%} footer colors {%- endcomment -%}

  {%- assign color_footer_bg = settings.footer_bg -%}
  {%- assign color_footer_bg_lighten = settings.footer_bg | color_lighten: 4 -%}
  {%- assign color_footer_bg_lighten_alt = settings.footer_bg | color_lighten: 8 -%}

  {%- assign color_footer_txt = settings.footer_txt -%}
  {%- assign color_footer_accent = settings.footer_accent -%}

  {%- comment -%} grid colors {%- endcomment -%}

  {%- assign color_grid_bg = settings.grid_color_bg -%}
  {%- assign color_grid_text = settings.grid_color_text -%}

  {%- comment -%} -- fonts -- {%- endcomment -%}

  {{ headings_font | font_face: font_display: 'swap' }}

  {{ body_font | font_face: font_display: 'swap' }}

  {%- assign body_font_medium = body_font | font_modify: 'weight', '500' -%}
  {%- assign body_font_semibold = body_font | font_modify: 'weight', '600' -%}
  {%- assign body_font_bold = body_font | font_modify: 'weight', '700' -%}
  {%- assign body_font_italic = body_font | font_modify: 'style', 'italic' -%}
  {%- assign body_font_bold_italic = body_font_bold | font_modify: 'style', 'italic' -%}

  {%- if body_font_medium -%}
    {{ body_font_medium | font_face: font_display: 'swap' }}
  {%- endif -%}

  {%- if body_font_semibold -%}
    {{ body_font_semibold | font_face: font_display: 'swap' }}
  {%- endif -%}

  {%- if body_font_bold -%}
    {{ body_font_bold | font_face: font_display: 'swap' }}
  {%- endif -%}

  {%- if body_font_italic -%}
    {{ body_font_italic | font_face: font_display: 'swap' }}
  {%- endif -%}

  {%- if body_font_bold_italic -%}
    {{ body_font_bold_italic | font_face: font_display: 'swap' }}
  {%- endif -%}

  :root {

    /* Color variables - SIDEBAR */

    --color-sidebar-bg: {{ color_sidebar_bg | color_extract: 'red' }}, {{ color_sidebar_bg | color_extract: 'green' }}, {{ color_sidebar_bg | color_extract: 'blue' }};
    --color-sidebar-bg-darken: {{ color_sidebar_bg_darken | color_extract: 'red' }}, {{ color_sidebar_bg_darken | color_extract: 'green' }}, {{ color_sidebar_bg_darken | color_extract: 'blue' }};
    --color-sidebar-bg-darken-alt: {{ color_sidebar_bg_darken_alt | color_extract: 'red' }}, {{ color_sidebar_bg_darken_alt | color_extract: 'green' }}, {{ color_sidebar_bg_darken_alt | color_extract: 'blue' }};
    --color-sidebar-bg-lighten: {{ color_sidebar_bg_lighten | color_extract: 'red' }}, {{ color_sidebar_bg_lighten | color_extract: 'green' }}, {{ color_sidebar_bg_lighten | color_extract: 'blue' }};
    --color-sidebar-bg-lighten-alt: {{ color_sidebar_bg_lighten_alt | color_extract: 'red' }}, {{ color_sidebar_bg_lighten_alt | color_extract: 'green' }}, {{ color_sidebar_bg_lighten_alt | color_extract: 'blue' }};

    --color-sidebar-txt: {{ color_sidebar_txt | color_extract: 'red' }}, {{ color_sidebar_txt | color_extract: 'green' }}, {{ color_sidebar_txt | color_extract: 'blue' }};
    --color-sidebar-txt-foreground: {{ color_sidebar_txt_foreground | color_extract: 'red' }}, {{ color_sidebar_txt_foreground | color_extract: 'green' }}, {{ color_sidebar_txt_foreground | color_extract: 'blue' }};
    --color-sidebar-txt-lighten-alt: {{ color_sidebar_txt_lighten_alt | color_extract: 'red' }}, {{ color_sidebar_txt_lighten_alt | color_extract: 'green' }}, {{ color_sidebar_txt_lighten_alt | color_extract: 'blue' }};

    --color-sidebar-accent: {{ color_sidebar_accent | color_extract: 'red' }}, {{ color_sidebar_accent | color_extract: 'green' }}, {{ color_sidebar_accent | color_extract: 'blue' }};
    --color-sidebar-accent-foreground: {{ color_sidebar_accent_foreground | color_extract: 'red' }}, {{ color_sidebar_accent_foreground | color_extract: 'green' }}, {{ color_sidebar_accent_foreground | color_extract: 'blue' }};

    /* Color variables - BODY */

    --color-body-bg: {{ color_body_bg | color_extract: 'red' }}, {{ color_body_bg | color_extract: 'green' }}, {{ color_body_bg | color_extract: 'blue' }};
    --color-body-bg-darken: {{ color_body_bg_darken | color_extract: 'red' }}, {{ color_body_bg_darken | color_extract: 'green' }}, {{ color_body_bg_darken | color_extract: 'blue' }};
    --color-body-bg-darken-alt: {{ color_body_bg_darken_alt | color_extract: 'red' }}, {{ color_body_bg_darken_alt | color_extract: 'green' }}, {{ color_body_bg_darken_alt | color_extract: 'blue' }};

    --color-body-txt: {{ color_body_txt | color_extract: 'red' }}, {{ color_body_txt | color_extract: 'green' }}, {{ color_body_txt | color_extract: 'blue' }};
    --color-body-txt-lighten: {{ color_body_txt_lighten | color_extract: 'red' }}, {{ color_body_txt_lighten | color_extract: 'green' }}, {{ color_body_txt_lighten | color_extract: 'blue' }};
    --color-body-txt-foreground: {{ color_body_txt_foreground | color_extract: 'red' }}, {{ color_body_txt_foreground | color_extract: 'green' }}, {{ color_body_txt_foreground | color_extract: 'blue' }};

    --color-body-accent: {{ color_body_accent | color_extract: 'red' }}, {{ color_body_accent | color_extract: 'green' }}, {{ color_body_accent | color_extract: 'blue' }};
    --color-body-accent-foreground: {{ color_body_accent_foreground | color_extract: 'red' }}, {{ color_body_accent_foreground | color_extract: 'green' }}, {{ color_body_accent_foreground | color_extract: 'blue' }};

    /* Color variables - FOOTER */

    --color-footer-bg: {{ color_footer_bg | color_extract: 'red' }}, {{ color_footer_bg | color_extract: 'green' }}, {{ color_footer_bg | color_extract: 'blue' }};
    --color-footer-bg-lighten: {{ color_footer_bg_lighten | color_extract: 'red' }}, {{ color_footer_bg_lighten | color_extract: 'green' }}, {{ color_footer_bg_lighten | color_extract: 'blue' }};
    --color-footer-bg-lighten-alt: {{ color_footer_bg_lighten_alt | color_extract: 'red' }}, {{ color_footer_bg_lighten_alt | color_extract: 'green' }}, {{ color_footer_bg_lighten_alt | color_extract: 'blue' }};
    --color-footer-txt: {{ color_footer_txt | color_extract: 'red' }}, {{ color_footer_txt | color_extract: 'green' }}, {{ color_footer_txt | color_extract: 'blue' }};
    --color-footer-accent: {{ color_footer_accent | color_extract: 'red' }}, {{ color_footer_accent | color_extract: 'green' }}, {{ color_footer_accent | color_extract: 'blue' }};

    /* Color variables - GRID */

    --color-grid-bg: {{ color_grid_bg | color_extract: 'red' }}, {{ color_grid_bg | color_extract: 'green' }}, {{ color_grid_bg | color_extract: 'blue' }};
    --color-grid-text: {{ color_grid_text | color_extract: 'red' }}, {{ color_grid_text | color_extract: 'green' }}, {{ color_grid_text | color_extract: 'blue' }};

    /* Font variables */

    --base-headings-size: {{ settings.headings_size }};
    --base-headings-size-alt: {{ settings.headings_size_alt }};
    --base-body-size: {{ settings.body_size }};
    --base-body-size-alt: {{ settings.body_size_alt }};

    --font-stack-headings: {{ headings_font.family }}, {{ headings_font.fallback_families }};
    --font-weight-headings: {{ headings_font.weight }};
    --font-style-headings: {{ headings_font.style }};

    --font-stack-body: {{ body_font.family }}, {{ body_font.fallback_families }};
    --font-weight-body: {{ body_font.weight }};
    --font-style-body: {{ body_font.style }};

    --font-stack-quote: {{ quotes_font.family }}, {{ quotes_font.fallback_families }};
    --font-weight-quote: {{ quotes_font.weight }};
    --font-style-quote: {{ quotes_font.style }};

    {%- if body_font_medium -%}
      --font-weight-body-medium: 500; 
    {%- elsif body_font_semibold %}
      --font-weight-body-medium: 600;
    {% elsif body_font_bold %}
      --font-weight-body-medium: 700;
    {%- endif -%}

    {%- if body_font_semibold -%}
      --font-weight-body-semibold: 600; 
    {%- else %}
      --font-weight-body-semibold: 700;
    {% endif %}

    --font-weight-body-bold: 700;

  }

</style>